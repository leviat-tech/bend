{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 6baae45f94f8dd6ae3cb","webpack:///./src/bend.js","webpack:///./node_modules/@crhio/vector/lib/vector.min.js"],"names":["Bend","path","initialPosition","x","y","initialDirection","realThreshold","words","d","instructions","params","radius","pop","unshift","type","s","push","l","projectedLength","parseFloat","length","pivotLength","index","shift","lengthToTangent","w","angle","barR","i","bendR","angleValue","loopCount","Math","abs","tan","bb","div","n","atan","p","neg","draw","barRadius","pen","instruction","commands","bendRadius","forward","position","add","direction","scale","bend","r","rotateDeg","sf","dist","sagitta","sqrt","sSign","svgParams","turn","bendZ","turnZ","drawProjected","cmdPt","invertParams","sp","slice","splice","fuzzyEqual","epsilon","fuzzyEqualPt","ptA","ptB","ptIsOnSegment","x1","y1","x2","y2","dxc","dyc","dxl","dyl","cross","isOnLine","xIsOnSegment","yIsOnSegment","segmentsAreColinear","segA","segB","line","instructionsToPath","list","map","join","verticesToPath","vertices","angleA","angleB","vec","subtract","magnitude","angleDeg","prototype","split","instructionList","stack","forEach","arg","stepPath","stepsOnly","filter","item","includes","cmds","newPen","newCommands","concat","projectedCommands","lengths","segments","invertY","command","prev","segs","cmd","next","translation","midpoint","points","projectedSegments","v","segment","lastSegment","innerVertices","bendInstructions","steps","reduce","termination","lastStep","firstStep","sign","isTurn","t","replacedInstruction","instructionIndex","indexOf","segLength","l1","l2","toggleBend","bends","oldAngle","isBendStraight","removeBend","s1","s2","s1Length","s2Length","rem","setSegmentLength","setBendAngle","reverse","lastPt","normalize","iType","ranges","lastI","merged","endpointA","endpointB","a","b","aVertices","aLastSeg","bVertices","bFirstSeg","endpointsCoincide","areColinear","aInstructions","dInstruction","find","sInstruction","print","moveto","lineto","arcto","init"],"mappings":"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","file":"bend.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"bend\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"bend\"] = factory();\n\telse\n\t\troot[\"bend\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6baae45f94f8dd6ae3cb","import Vector, { deg2rad, rad2deg } from '@crhio/vector';\n\n\nfunction Bend({\n  path = '',\n  initialPosition = { x: 0, y: 0 },\n  initialDirection = { x: 1, y: 0 },\n}) {\n  if (!(this instanceof Bend)) {\n    return new Bend({ path, initialPosition, initialDirection });\n  }\n\n  this.path = path;\n  this.initialPosition = Vector(initialPosition);\n  this.initialDirection = Vector(initialDirection);\n}\n\nconst realThreshold = 1e-8;\n \nconst words = {\n  d: ({ instructions, params }) => {\n    const radius = params.pop() / 2;\n    instructions.unshift({ type: 'barRadius', radius });\n    return { instructions, params };\n  },\n  s: ({ instructions, params }) => {\n    const radius = params.pop() / 2;\n    instructions.push({ type: 'bendRadius', radius });\n    return { instructions, params };\n  },\n  l: ({ instructions, params }) => {\n    const projectedLength = parseFloat(params.pop());\n    let length;\n    let pivotLength;\n    const index = instructions.length - 1;\n    if (instructions[index] && instructions[index].type === 'turn') {\n      length = projectedLength - instructions[index].shift;\n      pivotLength = length;\n    }\n    if (instructions[index] && instructions[index].type === 'bend') {\n      length = projectedLength - instructions[index].lengthToTangent - instructions[index].shift;\n      pivotLength = projectedLength - instructions[index].shift;\n    }\n    instructions.push({\n      type: 'forward',\n      length: length || projectedLength,\n      pivotLength: pivotLength || projectedLength,\n      projectedLength,\n    });\n    return { instructions, params };\n  },\n  w: ({ instructions, params }) => {\n    const angle = params.pop();\n    const index = instructions.length - 1;\n\n    // Find bend radius and bar radius, if any\n    let barR = 0;\n    for (let i = index; i >= 0; i -= 1) {\n      if (instructions[i].type === 'barRadius') {\n        barR = instructions[i].radius;\n        break;\n      }\n    }\n\n    let bendR = 0;\n    for (let i = index; i >= 0; i -= 1) {\n      if (instructions[i].type === 'bendRadius') {\n        bendR = instructions[i].radius + barR;\n        break;\n      }\n    }\n    let angleValue = angle;\n    let loopCount = 1;\n    if (Math.abs(angle) === 180) {\n      loopCount = 2;\n      angleValue = angle / 2;\n    }\n\n    for (let i = 1; i <= loopCount; i++) {\n      //  Bend reduces length of segment by tan(w/2) / radius\n      const shift = barR !== 0 ? Math.abs(barR * Math.tan(deg2rad(angleValue / 2))) : 0;\n      instructions[index].length -= shift;\n      instructions[index].pivotLength -= shift;\n\n      if (bendR === 0) {\n        // No bend radius results in a sharp turn\n        instructions.push({ type: 'turn', angleValue, shift });\n      } else {\n        // Bend radius requires modification of neighboring straight segments\n        const lengthToTangent = bendR / Math.tan(deg2rad(180 - Math.abs(angleValue)) / 2);\n        instructions[index].length -= lengthToTangent;\n        instructions.push({\n          type: 'bend', angle: angleValue, lengthToTangent, shift, radius: bendR,\n        });\n      }\n      if (loopCount === 2 && i === 1) {\n        const radius = bendR - barR;\n        instructions.push({ type: 'bendRadius', radius });\n\n        instructions.push({\n          type: 'forward',\n          length: 0,\n          pivotLength: 0,\n          radius: 0,\n        });\n      }\n    }\n    return { instructions, params };\n  },\n  bb: ({ instructions, params }) => {\n    const angle = params.pop();\n    const index = instructions.length - 1;\n\n    let barR = 0;\n    for (let i = index; i >= 0; i--) {\n      if (instructions[i].type === 'barRadius') {\n        barR = instructions[i].radius;\n        break;\n      }\n    }\n\n    let bendR = 0;\n    for (let i = index; i >= 0; i--) {\n      if (instructions[i].type === 'bendRadius') {\n        bendR = instructions[i].radius + barR;\n        break;\n      }\n    }\n\n    const shift = barR !== 0 ? Math.abs(barR * Math.tan(deg2rad(angle / 2))) : 0;\n    instructions[index].length -= shift;\n    instructions[index].pivotLength -= shift;\n\n    if (bendR === 0) {\n      instructions.push({ type: 'turnZ', angle, shift });\n    } else {\n      const lengthToTangent = bendR / Math.tan(deg2rad(180 - Math.abs(angle)) / 2);\n      instructions[index].length -= lengthToTangent;\n      instructions.push({\n        type: 'bendZ', angle, lengthToTangent, shift, radius: bendR,\n      });\n    }\n\n    return { instructions, params };\n  },\n  div: ({ instructions, params }) => {\n    const d = params.pop();\n    const n = params.pop();\n    params.push(n / d);\n    return { instructions, params };\n  },\n  atan: ({ instructions, params }) => {\n    const p = params.pop();\n    params.push(rad2deg(Math.atan(p)));\n    return { instructions, params };\n  },\n  neg: ({ instructions, params }) => {\n    const p = params.pop();\n    params.push(-p);\n    return { instructions, params };\n  },\n};\n\nconst draw = {\n  barRadius: ({ pen, instruction }) => ({\n    pen: { ...pen, barRadius: instruction.radius },\n    commands: null,\n  }),\n  bendRadius: ({ pen, instruction }) => ({\n    pen: { ...pen, bendRadius: instruction.radius },\n    commands: null,\n  }),\n  forward: ({ pen, instruction }) => {\n    const position = pen.position\n      .add(pen.direction.scale(instruction.length));\n    return {\n      pen: { ...pen, position },\n      commands: [{ type: 'lineto', params: [position.x, position.y] }],\n    };\n  },\n  bend: ({ pen, instruction }) => {\n    const bendR = pen.bendRadius || 0;\n    const barR = pen.barRadius || 0;\n    const r = bendR + barR;\n    const direction = pen.direction.rotateDeg(instruction.angle);\n    const position = pen.position\n      .add(pen.direction.scale(instruction.lengthToTangent))\n      .add(direction.scale(instruction.lengthToTangent));\n    const sf = instruction.angle > 0 ? 1 : 0;\n    const l = Vector(pen.position).dist(position) / 2;\n    const sagitta = r - Math.sqrt(r * r - l * l);\n    const sSign = sf === 1 ? 1 : -1;\n    return {\n      pen: { ...pen, position, direction },\n      commands: [{\n        type: 'arcto',\n        params: [position.x, position.y, sSign * (sagitta / l)],\n        svgParams: [r, r, 0, 0, sf, position.x, position.y],\n      }],\n    };\n  },\n  turn: ({ pen, instruction }) => ({\n    pen: { ...pen, direction: pen.direction.rotateDeg(instruction.angle) },\n    commands: null,\n  }),\n  bendZ: ({ pen, instruction }) => {\n    const bendR = pen.bendRadius ?? 0;\n    const barR = pen.barRadius ?? 0;\n    const r = bendR + barR;\n    const direction = pen.direction.rotateDeg(instruction.angle); // Assuming Z-axis bend rotates in-plane\n    const position = pen.position\n      .add(pen.direction.scale(instruction.lengthToTangent))\n      .add(direction.scale(instruction.lengthToTangent));\n    const sf = instruction.angle > 0 ? 1 : 0;\n    const l = Vector(pen.position).dist(position) / 2;\n    const sagitta = r - Math.sqrt(r * r - l * l);\n    const sSign = sf === 1 ? 1 : -1;\n    return {\n      pen: { ...pen, position, direction },\n      commands: [{\n        type: 'arcto',\n        params: [position.x, position.y, sSign * (sagitta / l)],\n        svgParams: [r, r, 0, 0, sf, position.x, position.y],\n      }],\n    };\n  },\n  turnZ: ({ pen, instruction }) => ({\n    pen: { ...pen, direction: pen.direction.rotateDeg(instruction.angle) },\n    commands: null,\n  }),\n};\n\nconst drawProjected = {\n  ...draw,\n  forward: ({ pen, instruction }) => {\n    const position = pen.position\n      .add(pen.direction.scale(instruction.pivotLength));\n    return {\n      pen: { ...pen, position },\n      commands: [{ type: 'lineto', params: [position.x, position.y] }],\n    };\n  },\n  bend: ({ pen, instruction }) => ({\n    pen: { ...pen, direction: pen.direction.rotateDeg(instruction.angle) },\n    commands: null,\n  }),\n};\n\nconst cmdPt = ({ type, params }) => {\n  switch (type) {\n    default:\n      return { x: params[0], y: params[1] };\n  }\n};\n\nconst invertParams = ({ type, params: p, svgParams: sp }) => {\n  const params = p.slice();\n  params.splice(1, 1, -p[1]);\n\n  if (type === 'arcto') {\n    return {\n      type,\n      params: [p[0], -p[1], -p[2]],\n      svgParams: [sp[0], sp[1], sp[2], sp[3], sp[4] ? 0 : 1, sp[5], -sp[6]],\n    };\n  }\n  return {\n    type,\n    params,\n  };\n};\n\nconst fuzzyEqual = (x, y, epsilon = realThreshold) => Math.abs(x - y) < epsilon;\n\nconst fuzzyEqualPt = (ptA, ptB, epsilon = realThreshold) => fuzzyEqual(ptA.x, ptB.x, epsilon)\n  && fuzzyEqual(ptA.y, ptB.y, epsilon);\n\nconst ptIsOnSegment = ([{ x: x1, y: y1 }, { x: x2, y: y2 }], { x, y }) => {\n  const dxc = x - x1;\n  const dyc = y - y1;\n\n  const dxl = x2 - x1;\n  const dyl = y2 - y1;\n\n  const cross = dxc * dyl - dyc * dxl;\n  const isOnLine = fuzzyEqual(cross, 0);\n\n  const xIsOnSegment = x1 < x2\n    ? x1 <= x && x <= x2\n    : x2 <= x && x <= x1;\n\n  const yIsOnSegment = y1 < y2\n    ? y1 < y && y <= y2\n    : y2 <= y && y <= y1;\n\n  return isOnLine && xIsOnSegment && yIsOnSegment;\n};\n\nconst segmentsAreColinear = (segA, segB) => {\n  const line = [segA[0], segB[1]];\n  return ptIsOnSegment(line, segA[1]) && ptIsOnSegment(line, segB[0]);\n};\n\nconst instructionsToPath = (instructions) => {\n  const list = instructions.map(({ type, params }) => `${params.join(' ')} ${type}`);\n  return list.join(' ');\n};\n\nconst verticesToPath = (vertices, d = 0, s = 0) => {\n  const instructions = [\n    { type: 'd', params: [d] },\n    { type: 's', params: [s] },\n  ];\n\n  let angleA = 0;\n  let angleB = 0;\n  let segA = 0;\n  let segB = 0;\n  let shift = 0;\n\n  for (let i = 1; i < vertices.length; i += 1) {\n    const vec = Vector(vertices[i]).subtract(vertices[i - 1]);\n\n    segA = vec.magnitude();\n    angleA = vec.angleDeg();\n\n    const angle = i === 1 ? 0 : angleA - angleB;\n    shift = d !== 0 ? Math.abs((d / 2) * Math.tan(deg2rad(angle / 2))) : 0;\n    segA += shift;\n    segB += shift;\n\n    // Add preceding straight segment\n    if (i > 1) {\n      instructions.push({ type: 'l', params: [segB] });\n\n      // Add bend segment\n      if (angle !== 0) {\n        instructions.push({ type: 'w', params: [angle] });\n      }\n    }\n\n    // if last vertex, add final straight segment\n    if (i === vertices.length - 1) {\n      instructions.push({ type: 'l', params: [segA] });\n    }\n\n    // rotate segments\n    segB = segA;\n    angleB = angleA;\n  }\n\n  return instructionsToPath(instructions);\n};\n\nBend.prototype.list = function list() {\n  return this.path.split(' ');\n};\n\n// A structured form of the 'path' property\nBend.prototype.instructionList = function instructionList() {\n  const stack = {\n    instructions: [],\n    params: [],\n  };\n\n  this.list().forEach((arg) => {\n    if (words[arg]) {\n      stack.instructions.push({ type: arg, params: stack.params });\n      stack.params = [];\n    } else {\n      stack.params.push(arg);\n    }\n  });\n\n  return stack.instructions;\n};\n\n// The path object, minus bend radius & diameter commands\nBend.prototype.stepPath = function stepPath() {\n  const list = this.instructionList();\n\n  const stepsOnly = list.filter(item => !['d', 's'].includes(item.type));\n\n  return instructionsToPath(stepsOnly);\n};\n\n// The instruction list, computing vertices from bends\nBend.prototype.instructions = function instructions() {\n  let stack = {\n    instructions: [],\n    params: [],\n  };\n\n  this.list().forEach((arg) => {\n    if (words[arg]) {\n      stack = words[arg](stack);\n    } else {\n      stack.params.push(arg);\n    }\n  });\n\n  return stack.instructions;\n};\n\n// Path instructions translated into commands that map\n// onto SVG path commands\nBend.prototype.commands = function commands() {\n  let pen = {\n    position: this.initialPosition,\n    direction: this.initialDirection,\n  };\n\n  let cmds = [{ type: 'moveto', params: [pen.position.x, pen.position.y] }];\n\n  this.instructions().forEach((instruction) => {\n    const { pen: newPen, commands: newCommands } = draw[instruction.type]({ pen, instruction });\n    if (newCommands) cmds = cmds.concat(newCommands);\n    pen = newPen;\n  });\n\n  return cmds;\n};\n\n// A list of commands, using the projected (i.e., non-radiused) vertices\nBend.prototype.projectedCommands = function lengths() {\n  let pen = {\n    position: this.initialPosition,\n    direction: this.initialDirection,\n  };\n\n  let cmds = [{ type: 'moveto', params: [pen.position.x, pen.position.y] }];\n\n  this.instructions().forEach((instruction) => {\n    const { pen: newPen, commands: newCommands } = drawProjected[instruction.type]({ pen, instruction });\n    if (newCommands) cmds = cmds.concat(newCommands);\n    pen = newPen;\n  });\n\n  return cmds;\n};\n\n// A list of segments, converting bend instructions into arcs and lines\nBend.prototype.segments = function segments({ invertY = false } = {}) {\n  const commands = invertY\n    ? this.commands().map(command => invertParams(command))\n    : this.commands();\n\n  let prev = cmdPt(commands[0]);\n  const segs = [];\n  commands.slice(1).forEach((cmd) => {\n    const next = cmdPt(cmd);\n    const translation = Vector(next).subtract(prev);\n    const midpoint = Vector(prev).add(translation.scale(0.5));\n    segs.push({ type: cmd.type, points: [prev, next], midpoint });\n    prev = { x: next.x, y: next.y };\n  });\n\n  return segs;\n};\n\n// A list of segments using the projected vertices\nBend.prototype.projectedSegments = function projectedSegments({ invertY = false } = {}) {\n  const commands = invertY\n    ? this.projectedCommands().map(command => invertParams(command))\n    : this.projectedCommands();\n\n  let prev = cmdPt(commands[0]);\n  const segs = [];\n  commands.slice(1).forEach((cmd) => {\n    const next = cmdPt(cmd);\n    const translation = Vector(next).subtract(prev);\n    const midpoint = Vector(prev).add(translation.scale(0.5));\n    segs.push({ type: cmd.type, points: [prev, next], midpoint });\n    prev = { x: next.x, y: next.y };\n  });\n\n  return segs;\n};\n\n// A list of the projected vertices\nBend.prototype.vertices = function vertices() {\n  const segments = this.projectedSegments();\n  const v = segments\n    .map(segment => segment.points[0]);\n\n  const lastSegment = segments[segments.length - 1];\n\n  if (!fuzzyEqualPt(v[0], lastSegment.points[1])) {\n    v.push(lastSegment.points[1]);\n  }\n\n  return v;\n};\n\n// A list of the 'inner' vertices (excluding endpoints)\nBend.prototype.innerVertices = function innerVertices() {\n  const segments = this.projectedSegments();\n  segments.pop();\n  return segments.map(segment => segment.points[1]);\n};\n\n// A list of the 'bend' instructions\nBend.prototype.bendInstructions = function bendInstructions() {\n  const instructions = this.instructionList();\n\n  return instructions.filter(instruction => instruction.type === 'w');\n};\n\n// A list of operations performed to fabricate the shape from a single bar\nBend.prototype.steps = function steps() {\n  return this.instructions().reduce((s, instruction) => {\n    if (instruction.type === 'forward') {\n      s.push({\n        length: instruction.projectedLength,\n        termination: 'cut',\n      });\n    } else if (['bend', 'turn'].includes(instruction.type)) {\n      const lastStep = s[s.length - 1];\n      const firstStep = s[0];\n      lastStep.termination = 'bend';\n      lastStep.sign = Math.sign(instruction.angle);\n      lastStep.angle = Math.abs(instruction.angle);\n      const isTurn = firstStep && firstStep.termination === 'bend' && firstStep.sign !== lastStep.sign;\n      lastStep.turn = !!isTurn;\n    }\n\n    return s;\n  }, []);\n};\n\n// The overall length of the shape, accounting for arc lengths of bend segments\nBend.prototype.length = function length() {\n  return this.instructions().reduce((s, instruction) => {\n    if (instruction.type === 'forward') return s + instruction.length;\n    if (instruction.type === 'bend') {\n      return s + Math.abs(instruction.radius * deg2rad(instruction.angle));\n    }\n    return s;\n  }, 0);\n};\n\nBend.prototype.bend = function bend(index, t, angle) {\n  const instructions = this.instructionList();\n\n  // Find index of instruction to replace\n  const replacedInstruction = instructions\n    .filter(i => i.type === 'l')[index];\n  const instructionIndex = instructions.indexOf(replacedInstruction);\n\n  // Find distance along segment to bend\n  const segLength = parseFloat(replacedInstruction.params[0]);\n  const l1 = t * segLength;\n  const l2 = segLength - l1;\n\n  // Split straight segment into two, and insert new turn\n  instructions.splice(\n    instructionIndex,\n    1,\n    { type: 'l', params: [l1] },\n    { type: 'w', params: [angle] },\n    { type: 'l', params: [l2] },\n  );\n\n  // Create new Bend object\n  return new Bend({\n    path: instructionsToPath(instructions),\n    initialPosition: this.initialPosition,\n    initialDirection: this.initialDirection,\n  });\n};\n\nBend.prototype.toggleBend = function toggleBend(index) {\n  // Find bend to toggle\n  const instructions = this.instructionList();\n  const bends = instructions.filter(instruction => instruction.type === 'w');\n  const bend = bends[index];\n  const instructionIndex = instructions.indexOf(bend);\n  const oldAngle = parseFloat(bend.params[0]);\n\n  // Create new bend to replace it\n  let angle;\n  if (oldAngle > 0) {\n    angle = -90;\n  } else if (oldAngle < 0) {\n    angle = 0;\n  } else {\n    angle = 90;\n  }\n\n  // Replace existing bend with new bend\n  instructions[instructionIndex].params[0] = angle;\n\n  // Create new Bend object\n  return new Bend({\n    path: instructionsToPath(instructions),\n    initialPosition: this.initialPosition,\n    initialDirection: this.initialDirection,\n  });\n};\n\nBend.prototype.isBendStraight = function isBendStraight(index) {\n  const instructions = this.instructionList();\n  const bends = instructions.filter(instruction => instruction.type === 'w');\n  const bend = bends[index];\n  return parseFloat(bend.params[0]) === 0;\n};\n\nBend.prototype.removeBend = function removeBend(index) {\n  // Find bend to remove\n  const instructions = this.instructionList();\n  const bends = instructions.filter(instruction => instruction.type === 'w');\n  const bend = bends[index];\n  const instructionIndex = instructions.indexOf(bend);\n\n  // Join surrounding segments\n  const s1 = instructions[instructionIndex - 1];\n  const s2 = instructions[instructionIndex + 1];\n\n  const s1Length = s1.type === 'l' ? parseFloat(s1.params[0]) : 0;\n  const s2Length = s2.type === 'l' ? parseFloat(s2.params[0]) : 0;\n\n  let segs;\n  let i;\n  let rem;\n  if (s1 && s2) {\n    segs = [{ type: 'l', params: [s1Length + s2Length] }];\n    i = instructionIndex - 1;\n    rem = 3;\n  } else if (s1) {\n    segs = [s1];\n    i = instructionIndex - 1;\n    rem = 2;\n  } else if (s2) {\n    segs = [s2];\n    i = instructionIndex;\n    rem = 2;\n  } else {\n    segs = [];\n    i = instructionIndex;\n    rem = 1;\n  }\n\n  // Replace segments\n  instructions.splice(i, rem, ...segs);\n\n  // Create new Bend object\n  return new Bend({\n    path: instructionsToPath(instructions),\n    initialPosition: this.initialPosition,\n    initialDirection: this.initialDirection,\n  });\n};\n\nBend.prototype.setSegmentLength = function setSegmentLength(index, length) {\n  // Find straight segment to modify\n  const instructions = this.instructionList();\n  const segments = instructions.filter(instruction => instruction.type === 'l');\n  const segment = segments[index];\n  const instructionIndex = instructions.indexOf(segment);\n\n  // Replace length property in that segment\n  instructions[instructionIndex].params[0] = length;\n\n  // Create new Bend object\n  return new Bend({\n    path: instructionsToPath(instructions),\n    initialPosition: this.initialPosition,\n    initialDirection: this.initialDirection,\n  });\n};\n\nBend.prototype.setBendAngle = function setBendAngle(index, angle) {\n  // Find bend to modify\n  const instructions = this.instructionList();\n  const bends = instructions.filter(instruction => instruction.type === 'w');\n  const bend = bends[index];\n  const instructionIndex = instructions.indexOf(bend);\n\n  // Replace angle property in that instruction\n  instructions[instructionIndex].params[0] = angle;\n\n  // Create new Bend object\n  return new Bend({\n    path: instructionsToPath(instructions),\n    initialPosition: this.initialPosition,\n    initialDirection: this.initialDirection,\n  });\n};\n\nBend.prototype.reverse = function reverse() {\n  const segments = this.projectedSegments();\n  const lastSegment = segments[segments.length - 1];\n  const lastPt = lastSegment.points[1];\n  const direction = Vector(lastSegment.points[0])\n    .subtract(lastSegment.points[1])\n    .normalize();\n  const instructions = this.instructionList()\n    .reverse()\n    .map(({ type, params }) => ({ type, params: type === 'w' ? [-parseFloat(params[0])] : params }));\n  const iType = i => (['d', 's'].includes(i.type) ? 'a' : 'b');\n  const ranges = instructions.reduce((r, i) => {\n    if (r.length === 0) {\n      r.push([i]);\n      return r;\n    }\n\n    const lastI = r[r.length - 1][0];\n    if (iType(i) === iType(lastI)) {\n      r[r.length - 1].push(i);\n    } else {\n      r.push([i]);\n    }\n\n    return r;\n  }, []);\n\n  for (let i = 0; i < ranges.length; i += 1) {\n    const r = ranges[i];\n    if (iType(r[0]) === 'a') {\n      // Swap positions of d/s commands\n      ranges[i] = ranges[i - 1];\n      ranges[i - 1] = r;\n    }\n  }\n\n  const merged = [].concat(...ranges);\n\n  return new Bend({\n    path: instructionsToPath(merged),\n    initialPosition: lastPt,\n    initialDirection: direction,\n  });\n};\n\nBend.prototype.join = function join(bend, endpointA = 'end', endpointB = 'start') {\n  const a = endpointA === 'end' ? this : this.reverse();\n  const b = endpointB === 'start' ? bend : bend.reverse();\n\n  const aVertices = a.vertices();\n  const aLastSeg = [aVertices[aVertices.length - 2], aVertices[aVertices.length - 1]];\n  const bVertices = b.vertices();\n  const bFirstSeg = [bVertices[0], bVertices[1]];\n\n  const endpointsCoincide = fuzzyEqualPt(aVertices[aVertices.length - 1], bVertices[0]);\n  const areColinear = segmentsAreColinear(aLastSeg, bFirstSeg);\n\n  if (endpointsCoincide && !areColinear) {\n    aVertices.pop();\n  } else if (areColinear) {\n    aVertices.pop();\n    bVertices.shift();\n  }\n\n  const aInstructions = a.instructionList();\n  const vertices = aVertices.concat(bVertices);\n  const dInstruction = aInstructions.find(i => i.type === 'd');\n  const d = dInstruction ? dInstruction.params[0] : 0;\n  const sInstruction = aInstructions.find(i => i.type === 's');\n  const s = sInstruction ? sInstruction.params[0] : 0;\n\n  return new Bend({\n    path: verticesToPath(vertices, d, s),\n    initialPosition: aVertices[0],\n    initialDirection: a.initialDirection,\n  });\n};\n\nBend.prototype.print = function print({ invertY = false } = {}) {\n  const cmds = {\n    moveto: 'M',\n    lineto: 'L',\n    arcto: 'A',\n  };\n\n  return this.commands()\n    .map((command) => {\n      let cmd = command;\n\n      if (invertY) {\n        cmd = invertParams(command);\n      }\n\n      const svgParams = cmd.type === 'arcto' ? cmd.svgParams : cmd.params;\n\n      return [cmds[command.type], ...svgParams].join(' ');\n    }).join(' ');\n};\n\nexport default function (init) {\n  return new Bend(init);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/bend.js","!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(\"vector\",[],e):\"object\"==typeof exports?exports.vector=e():t.vector=e()}(\"undefined\"!=typeof self?self:this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,\"a\",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\"\",e(e.s=0)}([function(t,e,n){\"use strict\";function r(t){return t*(Math.PI/180)}function o(t){return t*(180/Math.PI)}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=t.y;if(!(this instanceof i))return new i({x:e,y:n});this.x=e||0,this.y=n||0}function u(t){return new i(t)}Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=u,e.deg2rad=r,e.rad2deg=o,i.prototype.cross=function(t){return this.x*t.y-this.y*t.x},i.prototype.dot=function(t){return this.x*t.x+this.y*t.y},i.prototype.divide=function(t){return new i({x:this.x/t.x,y:this.y/t.y})},i.prototype.magnitude=function(){return Math.sqrt(this.dot({x:this.x,y:this.y}))},i.prototype.length=function(){return this.magnitude()},i.prototype.add=function(t){return new i({x:this.x+t.x,y:this.y+t.y})},i.prototype.subtract=function(t){return new i({x:this.x-t.x,y:this.y-t.y})},i.prototype.midpoint=function(t){var e=this.subtract(t).reverse(),n=e.scale(.5);return this.add(n)},i.prototype.scale=function(t){return new i({x:this.x*t,y:this.y*t})},i.prototype.multiplyScalar=function(t){return this.scale(t)},i.prototype.angle=function(){return Math.atan2(this.y,this.x)},i.prototype.angleDeg=function(){return o(this.angle())},i.prototype.angleBetween=function(t){var e=new i(t);return Math.acos(this.dot(e)/(this.magnitude()*e.magnitude()))},i.prototype.angleBetweenDeg=function(t){return o(this.angleBetween(t))},i.prototype.reverse=function(){return new i({x:-this.x,y:-this.y})},i.prototype.invert=function(){return this.reverse()},i.prototype.normalize=function(){var t=this.magnitude();return t<=0?new i({x:0,y:0}):this.scale(1/t)},i.prototype.direction=function(t){var e=new i(t).subtract({x:this.x,y:this.y}),n=e.magnitude();return n<=0?new i({x:1,y:0}):e.scale(1/n)},i.prototype.equal=function(t){return this.x===t.x&&this.y===t.y},i.prototype.rotate=function(t){return new i({x:Math.cos(t)*this.x-Math.sin(t)*this.y,y:Math.sin(t)*this.x+Math.cos(t)*this.y})},i.prototype.rotateDeg=function(t){var e=r(t);return this.rotate(e)},i.prototype.dist=function(t){return this.subtract(t).magnitude()},i.prototype.distSq=function(t){var e=this.subtract(t);return e.dot({x:e.x,y:e.y})},i.prototype.clone=function(){return new i({x:this.x,y:this.y})},i.prototype.get=function(){return{x:this.x,y:this.y}}}])});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@crhio/vector/lib/vector.min.js\n// module id = 1\n// module chunks = 0"],"sourceRoot":""}